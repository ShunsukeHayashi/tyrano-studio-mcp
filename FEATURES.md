# TyranoStudio MCP Server - 全機能一覧

## 📋 目次
- [基本機能](#基本機能)
- [高度な機能](#高度な機能)
- [分析ツール](#分析ツール)
- [開発支援](#開発支援)

## 基本機能

### プロジェクト管理
| ツール名 | 説明 | 主な用途 |
|---------|------|---------|
| `list_projects` | プロジェクト一覧取得 | プロジェクトの確認 |
| `create_project` | 新規プロジェクト作成 | ゲーム開発開始 |
| `delete_project` | プロジェクト削除 | 不要プロジェクト削除 |
| `list_project_files` | ファイル一覧表示 | プロジェクト構造確認 |

### シナリオ操作
| ツール名 | 説明 | 主な用途 |
|---------|------|---------|
| `read_scenario` | シナリオ読み込み | 既存シナリオの確認 |
| `write_scenario` | シナリオ書き込み | シナリオの作成・編集 |
| `validate_scenario` | 構文検証 | エラー・警告の検出 |
| `generate_scenario_template` | テンプレート生成 | 素早いシナリオ作成 |

### リソース管理
| ツール名 | 説明 | 主な用途 |
|---------|------|---------|
| `add_image` | 画像追加 | 背景・キャラ画像の追加 |
| `add_audio` | 音声追加 | BGM・効果音の追加 |
| `list_audio` | 音声一覧 | 音声ファイル確認 |

### 設定管理
| ツール名 | 説明 | 主な用途 |
|---------|------|---------|
| `read_config` | 設定読み込み | Config.tjsの確認 |
| `write_config` | 設定書き込み | ゲーム設定の変更 |

## 高度な機能

### 構文検証（validate_scenario）
✅ **基本チェック**
- タグの開始/終了対応（if/endif, iscript/endscript, link/endlink）
- コメント行のスキップ

✅ **高度なチェック**
- ラベル存在確認（jump/call/link先の検証）
- リソースファイル存在確認
  - 画像（bgimage, fgimage, image）
  - 音声（bgm, sound）
  - 動画（video）
  - シナリオ（call先のストレージ）
- キャラクター定義追跡
- 未定義キャラクターの使用検出

✅ **統計情報**
- ラベル数
- ジャンプ/リンク数
- 定義済みキャラクター数

### テンプレート生成（generate_scenario_template）
📝 **5種類のテンプレート**

1. **basic_scene** - 基本シーン
   - 背景表示
   - テキスト表示
   - ジャンプ

2. **character_intro** - キャラクター登場
   - キャラ定義
   - キャラ表示
   - セリフ

3. **choice_branch** - 選択肢分岐
   - 2-3個の選択肢
   - 各分岐先
   - 結果表示

4. **dialogue** - 会話シーン
   - 複数キャラの会話
   - 順番に表示

5. **title_screen** - タイトル画面
   - はじめから
   - つづきから
   - 終了

## 分析ツール

### プロジェクト分析（analyze_project）
📊 **シナリオ統計**
- シナリオファイル数
- 総行数、テキスト行数
- 総文字数
- ラベル数、ジャンプ数、選択肢数
- 定義済みキャラクター数

📊 **推定プレイ時間**
- 平均読書速度600文字/分で計算
- 分・時間単位で表示

📊 **リソース統計**
- 各カテゴリのファイル数
  - 背景画像
  - キャラクター画像
  - その他画像
  - BGM
  - 効果音
  - 動画

📊 **一覧表示**
- シナリオファイル一覧
- 登場キャラクター一覧

### シナリオフロー解析（analyze_scenario_flow）
🔀 **フロー可視化**
- ラベル間の遷移マッピング
- ジャンプ・コール・選択肢の追跡
- 行番号付きラベル一覧

🔀 **Mermaidフローチャート**
- グラフ構文生成
- 選択肢分岐の可視化
- コール関係の表示（点線）

## 開発支援

### Git連携
| ツール名 | 説明 | 主な用途 |
|---------|------|---------|
| `git_init` | リポジトリ初期化 | バージョン管理開始 |
| `git_commit` | コミット | 変更の記録 |
| `git_status` | 状態確認 | 変更ファイル確認 |
| `git_log` | 履歴表示 | コミット履歴確認 |

### リソース最適化（optimize_resources）
⚡ **使用状況分析**
- 使用中ファイルの検出
- 未使用ファイルの特定
- 存在しない参照の検出

⚡ **サイズ分析**
- 総リソースサイズ
- カテゴリ別サイズ
- 削減可能サイズ

⚡ **最適化提案**
- 未使用ファイル削除提案
- 見つからないファイルの警告
- ファイル一覧（最大5件表示）

### 一括操作（batch_rename）
📝 **正規表現リネーム**
- パターンマッチング
- 一括置換
- エラーハンドリング

📝 **結果レポート**
- 成功リスト
- エラーリスト
- 合計件数

## TyranoScriptリファレンス（get_tyranoscript_reference）

### カテゴリ別タグ一覧
- **text** - テキスト・メッセージ系
- **character** - キャラクター系
- **background** - 背景・画像系
- **choice** - 選択肢・ジャンプ系
- **variable** - 変数・演算系
- **audio** - 音声系
- **all** - すべて

## 統計情報

### 実装済み機能数
- **合計ツール数**: 23個
- **基本機能**: 11個
- **高度な機能**: 4個
- **分析ツール**: 2個
- **開発支援**: 6個

### コード統計
- **総行数**: 1,600+行
- **言語**: Python 3.11
- **依存関係**: mcp >= 1.12.0

### テスト
- **E2Eテスト**: 6スイート
- **カバレッジ**: 全主要機能
- **CI/CD**: GitHub Actions

## 使用例

### 基本的なワークフロー
```python
# 1. プロジェクト作成
create_project("my_game", "tyranoscript_ja")

# 2. Git初期化
git_init("my_game")

# 3. シナリオ作成
generate_scenario_template("my_game", "scene1.ks", "basic_scene")

# 4. 検証
validate_scenario("my_game", "scene1.ks")

# 5. コミット
git_commit("my_game", "Initial scenario")

# 6. 分析
analyze_project("my_game")

# 7. 最適化
optimize_resources("my_game")
```

## ロードマップ

### 完了済み
- ✅ Phase 1: Core Features
- ✅ Phase 2: Enhanced Features
- ✅ Phase 3: Advanced Tools
- ✅ Phase 4: Integration & Optimization

### 今後の予定
- 🔜 画像圧縮機能
- 🔜 多言語対応フレームワーク
- 🔜 プラグインシステム
- 🔜 エクスポート機能拡張